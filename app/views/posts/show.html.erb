<h1>投稿詳細</h1>

<div>
  <strong>タイトル:</strong>
  <%= @post.title %>
</div>

<div>
  <strong>内容:</strong>
  <%= @post.content %>
</div>

<% if @post.image.attached? %>
  <div>
    <%= image_tag @post.image, style: "max-width: 500px;"%>
  </div>
<% end %>

<div>
  <small>投稿日時: <%= @post.created_at.strftime("%Y/%m/%d %H:%M") %></small>
</div>

<hr>
<h3>コメント一覧</h3>
<% @post.comments.each do |comment| %>
  <div style="border-bottom: 1px solid #eee; padding: 10px;">
    <p><%= comment.content %></p>
    <small><%= comment.created_at.strftime("%Y/%m/%d %H:%M") %></small>
    <% if authenticated? && comment.post.user == Current.user %>
      <%= button_to "削除", post_comment_path(@post, comment), method: :delete, data: { confirm: "削除しますか？" } %>
    <% end %>
  </div>
<% end %>
<h3>コメントを投稿する</h3>
<% if authenticated? %>
  <%= form_with model: [ @post, Comment.new ] do |f| %>
    <div>
      <%= f.text_area :content, rows: 3 %>
    </div>
    <%= f.submit "コメントする" %>
  <% end %>
<% else %>
  <p><%= link_to "ログイン", new_session_path %>するとコメントできます</p>
<% end %>

<% if authenticated? && @post.user == Current.user %>
  <%= link_to "編集する", edit_post_path(@post) %> |
<% end %>
<%= link_to "一覧に戻る", posts_path %>
